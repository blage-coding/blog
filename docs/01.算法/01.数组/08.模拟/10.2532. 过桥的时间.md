---
title: 2532. è¿‡æ¡¥çš„æ—¶é—´
date: 2023-07-07 14:16:20
permalink: /pages/cd481e/
categories:
  - ç®—æ³•
  - æ•°ç»„
  - æ¨¡æ‹Ÿ
tags:
  - Leetcode
  - æ¨¡æ‹Ÿ
author: 
  name: phan
  link: https://gitee.com/blage-coding
---
# [2532. è¿‡æ¡¥çš„æ—¶é—´](https://leetcode.cn/problems/time-to-cross-a-bridge/)

## 1.ğŸ˜­ğŸ˜­ğŸ˜­ç¬¬ä¸€éè¶…æ—¶

- ç”¨**å››ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—**ä¿å­˜æ¯ä¸ªå·¥äººå­˜åœ¨å››ç§çŠ¶æ€ï¼š
  - å·¦è¾¹ç­‰å¾…
  - å·¦è¾¹æ¬è¿
  - å³è¾¹ç­‰å¾…
  - å³è¾¹æ¬è¿
- æ¯ä¸ªå·¥äººå­˜åœ¨ä¸¤ç§è¡Œä¸ºï¼š
  - è¿‡æ¡¥ã€‚æŒ‰ç…§é¢˜æ„åªèƒ½<font color="red">**ä¸²è¡Œè¿‡æ¡¥**</font>ï¼Œå¹¶ä¸”å³è¾¹çš„å…ˆè¿‡æ¡¥ï¼Œæ‰è½®åˆ°å·¦è¾¹
  - æ¬è¿ã€‚æ¬è¿è¡Œä¸ºæ˜¯<font color="red">**å¹¶è¡Œ**</font>çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å…¶å®ƒå·¥äººåœ¨è¿‡æ¡¥æˆ–è€…æ˜¯æ¬è¿æ—¶ï¼Œå½“å‰å·¥äººçš„æ¬è¿è¡Œä¸ºä¸å—å½±å“ã€‚

é¢˜ç›®çš„éš¾ç‚¹åœ¨äº**å¦‚ä½•ç»Ÿè®¡æ€»æ—¶é•¿**ï¼Ÿè¿™é‡Œé‡‡ç”¨çš„ç®—æ³•æ˜¯æ ¹æ®**è¿‡æ¡¥æ—¶é—´æ¥ç»Ÿè®¡**ï¼Œå› ä¸ºæ•´ä¸ªè¿‡æ¡¥è¡Œä¸ºéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œæ‰€ä»¥å¯ä»¥**æŠŠæ¯ä¸ªå·¥äººçš„è¿‡æ¡¥è¡Œä¸ºä½œä¸ºæ—¶é—´ä¸»è½´**ã€‚å¦‚æœå½“å‰ä¸å­˜åœ¨â€œå¯è¿‡æ¡¥â€å·¥äººï¼Œé‚£ä¹ˆå°±å–å‡ºæœ€å¿«å®Œæˆæ¬è¿ä»»åŠ¡çš„å·¥äººå†è¿‡æ¡¥ã€‚

æ¬è¿è¡Œä¸ºæ˜¯å¹¶è¡Œçš„ï¼Œ**å› æ­¤<font color="red">æ¯è¿‡ä¸€æ¬¡æ¡¥å°±æ‰£å‡ä¸€æ¬¡æ‰€æœ‰æ‰§è¡Œæ¬è¿ä»»åŠ¡å·¥äººçš„æ—¶é•¿</font>ï¼Œæ ¹æ®æ¬è¿æ—¶é•¿æ˜¯å¦å°äºé›¶å†³å®šå°†å½“å‰å·¥äººçº³å…¥ç­‰å¾…é˜Ÿåˆ—**ã€‚è€Œè¿™ä¹Ÿæ˜¯è¶…æ—¶çš„ä¸»è¦åŸå› ã€‚

```java
class Solution {
    public  int findCrossingTime(int n, int k, int[][] time) {
        PriorityQueue<int[]> rightwork = new PriorityQueue<>(new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                return o1[1] - o2[1] ;
            }
        });
        PriorityQueue<int[]> rightwait = new PriorityQueue<>(new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                return o2[0] - o1[0] ;
            }
        });
        PriorityQueue<int[]> leftwork = new PriorityQueue<>(new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                return o1[1] - o2[1] ;
            }
        });
        PriorityQueue<int[]> leftwait = new PriorityQueue<>(new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                return o2[0] - o1[0] ;
            }
        });
        Deque<int[]> temp = new LinkedList<>();
        Arrays.sort(time, new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                return o1[0] + o1[2] - o2[0] - o2[2];
            }
        });
        for (int i = time.length - 1; i >= 0; i--) {
            leftwait.offer(new int[]{i,time[i][0]});
        }

        int index = time.length - 1, res = 0, box = 0;
        while (box < n) {
            //å³è¾¹å…ˆè¿‡æ¡¥
            if (rightwait.size()>0) {
                int[] worker = rightwait.poll();
                //è¿‡æ¡¥æ—¶é—´
                int rightToleftTime = worker[1];
                res += rightToleftTime;
                //ç¼©å‡å·¦å³ä¸¤è¾¹å·¥ä½œæ—¶é—´
                refresh(leftwork,leftwait,temp,time,leftwork.size(),rightToleftTime,0);
                refresh(rightwork,rightwait,temp,time,rightwork.size(),rightToleftTime,2);
                leftwork.offer(new int[]{worker[0], time[worker[0]][3]});
            }
            //å·¦è¾¹è¿‡æ¡¥
            else if(rightwait.size() == 0&&leftwait.size()>0){
                int[] worker = leftwait.poll();
                //è¿‡æ¡¥æ—¶é—´
                int lefttorightTime = worker[1];
                res += lefttorightTime;
                //ç¼©å‡å·¦å³ä¸¤è¾¹å·¥ä½œæ—¶é—´
                refresh(leftwork,leftwait,temp,time,leftwork.size(),lefttorightTime,0);
                refresh(rightwork,rightwait,temp,time,rightwork.size(),lefttorightTime,2);
                rightwork.offer(new int[]{worker[0], time[worker[0]][1]});
                box++;
            }
            //å·¦å³ä¸¤è¾¹æ²¡æœ‰ç©ºé—²workerï¼ŒåŒæ—¶éƒ½åœ¨å·¥ä½œï¼Œåˆ™å–å‡ºæœ€å¿«å®Œæˆæ¬è¿å·¥ä½œçš„worker
            else if (rightwait.size() == 0 && leftwait.size() == 0) {
                int timeing=0;
                if(rightwork.size()!=0&&leftwork.size()!=0&&rightwork.peek()[1]==leftwork.peek()[1]){
                    //åŒæ—¶å®Œæˆ
                    int[] poll=leftwork.poll();
                    timeing = poll[1];
                    leftwait.offer(new int[]{poll[0], time[poll[0]][0]});
                    poll=rightwork.poll();
                    rightwait.offer(new int[]{poll[0], time[poll[0]][2]});
                }
                else{
                    if(!rightwork.isEmpty()&&!leftwork.isEmpty()){
                        if (rightwork.peek()[1] > leftwork.peek()[1]) {
                            int[] poll = leftwork.poll();
                            leftwait.offer(new int[]{poll[0], time[poll[0]][0]});
                            timeing = poll[1];
                        }
                        else{
                            int[] poll = rightwork.poll();
                            rightwait.offer(new int[]{poll[0], time[poll[0]][2]});
                            timeing = poll[1];
                        }
                    }
                    else {
                        if(rightwork.isEmpty()){
                            int[] poll = leftwork.poll();
                            leftwait.offer(new int[]{poll[0], time[poll[0]][0]});
                            timeing = poll[1];

                        }
                        else{
                            int[] poll = rightwork.poll();
                            rightwait.offer(new int[]{poll[0], time[poll[0]][2]});
                            timeing = poll[1];
                        }
                    }
                }
                res += timeing;
                refresh(leftwork,leftwait,temp,time,leftwork.size(),timeing,0);
                refresh(rightwork,rightwait,temp,time,rightwork.size(),timeing,2);
            }
        }
        //æœ€åå¤„ç†å³è¾¹
        while(rightwork.size()>0||rightwait.size()>0){
            //è¿‡æ¡¥
            if(rightwait.size()>0){
                int[] poll = rightwait.poll();
                res += poll[1];
                refresh(rightwork,rightwait,temp,time,rightwork.size(),poll[1],2);
            }
            //å³è¾¹æ¬è¿
            else{
                int[] poll = rightwork.poll();
                res += poll[1];
                rightwait.offer(new int[]{poll[0], time[poll[0]][2]});
                refresh(rightwork,rightwait,temp,time,rightwork.size(),poll[1],2);
            }
        }

        return res;
    }
    //åˆ·æ–°å·¥ä½œé˜Ÿåˆ—æ‰€æœ‰workerçš„å‰©ä½™æ¬è¿æ—¶é—´
    public  void refresh(PriorityQueue<int[]> work,PriorityQueue<int[]> wait,Deque<int[]> temp,int[][] time,int len,int crosstime,int refreshinx){
        int lworkinx = 0;
        while (lworkinx<len) {
            int[] worker = work.poll();
            //è¿‡æ¡¥æœŸé—´åšå®Œçš„
            if (worker[1]<=crosstime) {
                wait.offer(new int[]{worker[0],time[worker[0]][refreshinx]});
            }
            //æ²¡åšå®Œçš„é‡æ–°åŠ å…¥é˜Ÿåˆ—
            else{
                worker[1] -= crosstime;
                temp.offer(worker);
            }
            lworkinx++;
            if(lworkinx==len){
                while (temp.size() > 0) {
                    work.offer(temp.poll());
                }
            }
        }
    }
}
```

## 2.ä¼˜åŒ–

ä¼˜åŒ–ï¼š<font color="red">**æ¬è¿é˜Ÿåˆ—ç›´æ¥ä¿å­˜å®Œæˆè¯¥æ¬è¿ä»»åŠ¡çš„"æ—¶åˆ»"ï¼Œè€Œä¸æ˜¯æ—¶é—´é—´éš”**</font>ã€‚

ä¸Šä¸€ç§æ–¹æ³•é‡Œï¼Œæ¬è¿é˜Ÿåˆ—ä¿å­˜çš„æ˜¯å®Œæˆæ•´ä¸ªæ¬è¿ä»»åŠ¡**æ‰€éœ€è¦çš„æ—¶é—´(pickNew/putOld**)ï¼Œä¹Ÿå°±æ˜¯æ—¶é—´é—´éš”ã€‚å› æ­¤**æ¯ç»è¿‡ä¸€æ®µè¿‡æ¡¥æ—¶é•¿**ï¼Œ**æ‰€æœ‰çš„æ¬è¿ä»»åŠ¡éƒ½éœ€è¦refreshåˆ·æ–°æ‰£å‡**ï¼Œå¦åˆ™æ— æ³•åˆ¤æ–­æ¯ä¸ªå¹¶è¡Œçš„æ¬è¿ä»»åŠ¡å®Œæˆå¹¶åŠ å…¥ç­‰å¾…é˜Ÿåˆ—çš„æ—¶æœºã€‚

è€Œä¼˜åŒ–è¿‡åï¼Œæ•´ä¸ªè¿‡æ¡¥é€»è¾‘å¦‚ä¸‹ï¼š

1. å…ˆè¿‡æ¡¥ï¼Œå¹¶æ›´æ–°è®°å½•å½“å‰å®Œæˆè¿‡æ¡¥åˆ°è¾¾å¯¹å²¸çš„æ—¶åˆ»res
   - è¿‡æ¡¥åçš„å·¥äºº**çº³å…¥å¯¹å²¸æ¬è¿ä»»åŠ¡é˜Ÿåˆ—**ï¼Œä»–å®Œæˆè¿™ä¸ªæ¬è¿ä»»åŠ¡çš„æ—¶åˆ»åº”è¯¥ç­‰äº<font color="red">**res(åˆ°è¾¾å¯¹å²¸çš„æ—¶åˆ»)+pickNew(åšå®Œè¿™ä¸ªæ¬è¿ä»»åŠ¡çš„æ—¶é—´é—´éš”**</font>)ã€‚
2. ç»Ÿè®¡è¿‡æ¡¥æœŸé—´å®Œæˆæ¬è¿ä»»åŠ¡çº³å…¥ç­‰å¾…é˜Ÿåˆ—çš„å·¥äººï¼š
   - res**å¤§äº**æ¬è¿ä»»åŠ¡é˜Ÿåˆ—çš„æ—¶åˆ»ï¼Œ**è¯´æ˜è¿™ä¸ªæ¬è¿ä»»åŠ¡åœ¨è¿‡æ¡¥æœŸé—´åšå®Œäº†**ï¼Œå°†å®ƒçº³å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚

å¦‚æœå½“å‰å·¦å³ä¸¤å²¸çš„ç­‰å¾…é˜Ÿåˆ—éƒ½æ²¡äººï¼Œä¸å­˜åœ¨è¿‡æ¡¥æ¡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦ç­‰å¾…æœ€å¿«çš„å·¥äººæ¬å®Œï¼Œå¹¶<font color="red">**å°†ä¸‹ä¸€æ¬¡è¿‡æ¡¥å‰çš„æ—¶åˆ»resæ›´æ–°ä¸ºå®Œæˆæ¬è¿ä»»åŠ¡çš„æ—¶åˆ»**</font>ã€‚

é¢„å¤„ç†æ­¥éª¤ï¼š

- é¦–å…ˆå¯¹timeæ’åºï¼Œä¿è¯**ç´¢å¼•å¤§çš„å·¥äººæ•ˆç‡ä½**ã€‚
- æ¬è¿é˜Ÿåˆ—leftworkå’Œrightworkæ¯”è¾ƒå™¨æŒ‰ç…§å®Œæˆæ¬è¿æ—¶åˆ»å‡åºæ’åºã€‚ç­‰å¾…é˜Ÿåˆ—leftwaitå’Œrightwaitæ¯”è¾ƒå™¨æŒ‰ç…§timeçš„å·¥äººç´¢å¼•ä¸‹æ ‡é™åºæ’åºã€‚
- é˜Ÿåˆ—éœ€è¦ä¿å­˜ç´¢å¼•indexã€‚ä»è€Œä¿è¯å·¥äººçŠ¶æ€åˆ‡æ¢æ—¶ï¼Œå¯ä»¥æ ¹æ®ç´¢å¼•ä»timeä¸­è·å–æ•°æ®ã€‚

```java
class Solution {
    public int findCrossingTime(int n, int k, int[][] time) {
        PriorityQueue<int[]> rightwork = new PriorityQueue<>(new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                return o1[1] - o2[1] ;
            }
        });
        PriorityQueue<int[]> rightwait = new PriorityQueue<>(new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                return o2[0] - o1[0] ;
            }
        });
        PriorityQueue<int[]> leftwork = new PriorityQueue<>(new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                return o1[1] - o2[1] ;
            }
        });
        PriorityQueue<int[]> leftwait = new PriorityQueue<>(new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                return o2[0] - o1[0] ;
            }
        });
        Deque<int[]> temp = new LinkedList<>();
        Arrays.sort(time, new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                return o1[0] + o1[2] - o2[0] - o2[2];
            }
        });
        for (int i = time.length - 1; i >= 0; i--) {
            leftwait.offer(new int[]{i,time[i][0]});
        }
        int res = 0, box = 0;
        while (box < n) {
           //å³å¾€å·¦
            if (rightwait.size() > 0) {
                int[] toLeft = rightwait.poll();
                res += toLeft[1];
                //å°†å·¥äººä»æ¬è¿é˜Ÿåˆ—æ·»åŠ åˆ°ç­‰å¾…é˜Ÿåˆ—
                while(leftwork.size()>0&&leftwork.peek()[1]<=res){
                    int[] poll = leftwork.poll();
                    leftwait.offer(new int[]{poll[0], time[poll[0]][0]});
                }
                while(rightwork.size()>0&&rightwork.peek()[1]<=res){
                    int[] poll = rightwork.poll();
                    rightwait.offer(new int[]{poll[0], time[poll[0]][2]});
                }
                leftwork.offer(new int[]{toLeft[0], res + time[toLeft[0]][3]});
            }
            //å·¦å¾€å³
            else if (rightwait.size() == 0 && leftwait.size() > 0) {
                int[] tiright = leftwait.poll();
                res += tiright[1];
                //å°†å·¥äººä»æ¬è¿é˜Ÿåˆ—æ·»åŠ åˆ°ç­‰å¾…é˜Ÿåˆ—
                while(leftwork.size()>0&&leftwork.peek()[1]<=res){
                    int[] poll = leftwork.poll();
                    leftwait.offer(new int[]{poll[0], time[poll[0]][0]});
                }
                while(rightwork.size()>0&&rightwork.peek()[1]<=res){
                    int[] poll = rightwork.poll();
                    rightwait.offer(new int[]{poll[0], time[poll[0]][2]});
                }
                rightwork.offer(new int[]{tiright[0], res + time[tiright[0]][1]});
                box++;
            }
            //ä¸¤è¾¹éƒ½æ²¡æœ‰ç­‰å¾…é˜Ÿåˆ—ï¼Œå–å‡ºæœ€å¿«å®Œæˆæ¬è¿ä»»åŠ¡çš„å·¥äºº
            else {
                if(leftwork.size()==0){
                    int[] poll = rightwork.poll();
                    res = poll[1];
                    rightwait.offer(new int[]{poll[0], time[poll[0]][2]});
                } else if (rightwork.size() == 0) {
                    int[] poll = leftwork.poll();
                    res = poll[1];
                    leftwait.offer(new int[]{poll[0], time[poll[0]][0]});
                }
                else{
                    if(leftwork.peek()[1]<rightwork.peek()[1]){
                        int[] poll = leftwork.poll();
                        res = poll[1];
                        leftwait.offer(new int[]{poll[0], time[poll[0]][0]});
                    } else if (leftwork.peek()[1] > rightwork.peek()[1]) {
                        int[] poll = rightwork.poll();
                        res = poll[1];
                        rightwait.offer(new int[]{poll[0], time[poll[0]][2]});
                    }
                    //å·¦å³ä¸¤è¾¹æ¬è¿å·¥äººåŒæ—¶å‡ºæ ˆ
                    else{
                        int[] poll = leftwork.poll();
                        res = poll[1];
                        leftwait.offer(new int[]{poll[0], time[poll[0]][0]});
                        poll=rightwork.poll();
                        rightwait.offer(new int[]{poll[0], time[poll[0]][2]});
                    }
                }
            }
        }
        //ç¬¬nä¸ªå·¥äººåˆ°å³å²¸åï¼Œå¤„ç†å‰©ä½™å³å²¸çš„æ¬è¿ä»»åŠ¡
        while(rightwork.size()>0||rightwait.size()>0){
            //å³è¾¹æœ‰äººç­‰å¾…
            if (rightwait.size() > 0) {
                int[] poll = rightwait.poll();
                res += poll[1];
                while(rightwork.size()>0&&rightwork.peek()[1]<=res){
                    int[] out = rightwork.poll();
                    rightwait.offer(new int[]{out[0], time[out[0]][2]});
                }
            }
            //å³è¾¹æ²¡äººç­‰ï¼Œåˆ™å–å‡ºæœ€å…ˆæ¬å®Œæ´»çš„å·¥äºº
            else{
                int[] poll = rightwork.poll();
                res = poll[1];
                rightwait.offer(new int[]{poll[0], time[poll[0]][2]});
            }
        }
        return res;
    }
}
```

